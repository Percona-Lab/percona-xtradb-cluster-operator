.. _operator.custom-resource-options:

`Custom Resource options <operator.html#operator-custom-resource-options>`_
===============================================================================

The operator is configured via the spec section of the
`deploy/cr.yaml <https://github.com/percona/percona-xtradb-cluster-operator/blob/master/deploy/cr.yaml>`_
file. This file contains the following spec sections to configure three
main subsystems of the cluster:


.. csv-table:: Custom Resource options
    :header: "Key", "Value Type", "Description"
    :widths: 15, 15, 40
    :delim: ,


    "pxc", "subdoc", "Percona XtraDB Cluster general section"
    "proxysql", "subdoc", "ProxySQL section"
    "pmm", "subdoc", "Percona Moonitoring and Management section"
    "backup", "subdoc", "Percona XtraDB Cluster backups section"


.. _operator.pxc-section:

`PXC Section <operator.html#operator-pxc-section>`_
--------------------------------------------------------------------------------

The ``pxc`` section in the `deploy/cr.yaml <https://github.com/percona/percona-xtradb-cluster-operator/blob/master/deploy/cr.yaml>`_ file contains general
configuration options for the Percona XtraDB Cluster.

+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | size                                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``3``                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The size of the Percona XtraDB cluster must be >= 3 for                                   |
|                 | `High Availability <https://www.percona.com/doc/percona-xtradb-cluster/5.7/intro.html>`_  |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | allowUnsafeConfigurations                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | boolean                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``false``                                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Prevents users from configuring a cluster with unsafe parameters such as starting the     |
|                 | cluster with less than 3 nodes or starting the cluster without TLS/SSL certificates       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | image                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``percona/percona-xtradb-cluster-operator:1.0.0-pxc``                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The Docker image of the Percona cluster used                                              |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | readinessDelaySec                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``15``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Adds a delay before a run check to verify the application is ready to process traffic     |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | livenessDelaySec                                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``300``                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Adds a delay before the run check ensures the application is healthy and capable of       |
|                 | processing requests                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | forceUnsafeBootstrap                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | boolean                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``false``                                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The setting can be reset in case of a sudden crash when all nodes may be considered       |
|                 | unsafe to bootstrap from. The setting lets a node be selected and set to                  |
|                 | ``safe_to_bootstrap`` and provides data recovery                                          |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | configuration                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``|``   ``[mysqld]``    ``wsrep_debug=ON``                                                |
|                 | ``wsrep-provider_options=gcache.size=1G;gcache.recover=yes``                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The ``my.cnf`` file options to be passed to Percona XtraDB cluster nodes                  |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | imagePullSecrets.name                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``private-registry-credentials``                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes ImagePullSecret                                                           |
|                 | <https://kubernetes.io/docs/concepts/configuration/secret/#using-imagepullsecrets>`_      |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | priorityClassName                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``high-priority``                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes Pod priority class                                                        |
|                 | <https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/               |
|                 | #priorityclass>`_                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | annotations                                                                               |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | label                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``iam.amazonaws.com/role: role-arn``                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes annotations                                                               |
|                 | <https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/>`_        |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | labels                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | label                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``rack: rack-22``                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Labels are key-value pairs attached to objects                                           |
|                 | <https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/>`_             |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | resources.requests.memory                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``1G``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes memory requests                                                           |
|                 | <https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/    |
|                 | #resource-requests-and-limits-of-pod-and-container>`_                                     |
|                 | for a PXC container                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | resources.requests.cpu                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``600m``                                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes CPU requests                                                                  |
|                 | <https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/    |
|                 | #resource-requests-and-limits-of-pod-and-container>`_ for a PXC container                 |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | resources.limits.memory                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``1G``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes memory limits                                                                 |
|                 | <https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/    |
|                 | #resource-requests-and-limits-of-pod-and-container>`_ for a PXC container                 |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | nodeSelector                                                                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | label                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``disktype: ssd``                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes nodeSelector                                                                  |
|                 | <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector>`_       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | affinity.topologyKey                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``kubernetes.io/hostname``                                                                |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The Operator `topology key                                                                |
|                 | <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/                       |
|                 | #affinity-and-anti-affinity>`_ node anti-affinity constraint                              |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | affinity.advanced                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | subdoc                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``kubernetes.io/hostname``                                                                |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | In cases where the Pods require complex tuning the `advanced` option turns off the        |
|                 | ``topologyKey`` effect. This setting allows the standard Kubernetes affinity constraints  |
|                 | of any complexity to be used                                                              |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | affinity.tolerations                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | subdoc                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``node.alpha.kubernetes.io/unreachable``                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes Pod tolerations                                                               |
|                 | <https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/>`_               |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | podDisruptionBudget.maxUnavailable                                                        |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``1``                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes podDisruptionBudget                                                       |
|                 | <https://kubernetes.io/docs/tasks/run-application/configure-pdb/                          |
|                 | #specifying-a-poddisruptionbudget>`_ specifies the number of Pods from the set            |
|                 | unavailable after the eviction                                                            |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | podDisruptionBudget.minAvailable                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``0``                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes podDisruptionBudget                                                       |
|                 | <https://kubernetes.io/docs/tasks/run-application/configure-pdb/                          |
|                 | #specifying-a-poddisruptionbudget>`_ Pods that must be available after an eviction        |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.emptyDir                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``{}``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes emptyDir volume                                                           |
|                 | <https://kubernetes.io/docs/concepts/storage/volumes/#emptydir>`_ The directory created   |
|                 | on a node and accessible to the PXC Pod containers                                        |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.hostPath.path                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``/data``                                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes hostPath <https://kubernetes.io/docs/concepts/storage/volumes/#hostpath>`_    |
|                 | The volume that mounts a directory from the host node's filesystem into your Pod. The     |
|                 | path property is required                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.hostPath.type                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``Directory``                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes hostPath <https://kubernetes.io/docs/concepts/storage/volumes/            |
|                 | #hostpath>`_. An optional property for the hostPath                                       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.persistentVolumeClaim.storageClassName                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``standard``                                                                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Set the `Kubernetes storage class                                                         |
|                 | <https://kubernetes.io/docs/concepts/storage/storage-classes/>`_ to use with the PXC      |
|                 | `PersistentVolumeClaim <https://kubernetes.io/docs/concepts/storage/persistent-volumes/   |
|                 | #persistentvolumeclaims>`_                                                                |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.persistentVolumeClaim.accessModes                                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | array                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``[ReadWriteOnce]``                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes PersistentVolumeClaim                                                     |
|                 | <https://kubernetes.io/docs/concepts/storage/persistent-volumes/                          |
|                 | #persistentvolumeclaims>`_ access modes for the Percona XtraDB cluster                    |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.resources.requests.storage                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``6Gi``                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes PersistentVolumeClaim                                                     |
|                 | <https://kubernetes.io/docs/concepts/storage/persistent-volumes/#                         |
|                 | persistentvolumeclaims>`_ size for the Percona XtraDB cluster                             |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | gracePeriod                                                                               |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``600``                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes grace period when terminating a Pod                                       |
|                 | <https://kubernetes.io/docs/concepts/workloads/pods/pod/#termination-of-pods>`_           |
+-----------------+-------------------------------------------------------------------------------------------+

.. _operator.proxysql-section:

`ProxySQL Section <operator.html#operator-proxysql-section>`_
--------------------------------------------------------------------------------

The ``proxysql`` section in the `deploy/cr.yaml <https://github.com/percona/percona-xtradb-cluster-operator/blob/master/deploy/cr.yaml>`_ file contains
configuration options for the ProxySQL daemon.

+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | enabled                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | boolean                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``true``                                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Enables or disables `load balancing with ProxySQL                                         |
|                 | <https://www.percona.com/doc/percona-xtradb-cluster/5.7/howtos/proxysql.html>`_ `Services |
|                 | <https://kubernetes.io/docs/concepts/services-networking/service/>`_                      |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | size                                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``1``                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The number of the ProxySQL daemons `to provide load balancing                             |
|                 | <https://www.percona.com/doc/percona-xtradb-cluster/5.7/howtos/proxysql.html>`_           |
|                 | must be = 1 in current release                                                            |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | image                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``percona/percona-xtradb-cluster-operator:1.0.0-proxysql``                                |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | ProxySQL Docker image to use                                                              |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | imagePullSecrets.name                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``private-registry-credentials``                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes imagePullSecrets                                                          |
|                 | <https://kubernetes.io/docs/concepts/configuration/secret/#using-imagepullsecrets>`_ for  |
|                 | the ProxySQL image                                                                        |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | annotations                                                                               |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | label                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``iam.amazonaws.com/role: role-arn``                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes annotations                                                               |
|                 | <https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/>`_        |
|                 | metadata                                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | labels                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | label                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``rack: rack-22``                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Labels are key-value pairs attached to objects                                           |
|                 | <https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/>`_             |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | servicetype                                                                               |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``ClusterIP``                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Specifies the type of `Kubernetes Service                                                 |
|                 | <https://kubernetes.io/docs/concepts/services-networking/service/                         |
|                 | #publishing-services-service-types>`_ to be used                                          |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | resources.requests.memory                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``1G``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes memory requests                                                           |
|                 | <https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/    |
|                 | #resource-requests-and-limits-of-pod-and-container>`_                                     |
|                 | for a ProxySQL container                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | resources.requests.cpu                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``600m``                                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes CPU requests                                                                  |
|                 | <https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/    |
|                 | #resource-requests-and-limits-of-pod-and-container>`_ for a ProxySQL container            |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | resources.limits.memory                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``1G``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes memory limits                                                                 |
|                 | <https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/    |
|                 | #resource-requests-and-limits-of-pod-and-container>`_ for a ProxySQL container            |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | resources.limits.cpu                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``700m``                                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes CPU limits                                                                    |
|                 | <https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/    |
|                 | #resource-requests-and-limits-of-pod-and-container>`_ for a ProxySQL container            |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | priorityClassName                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``high-priority``                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes Pod Priority class                                                        |
|                 | <https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/               |
|                 | #priorityclass>`_ for ProxySQL                                                            |
+-----------------+-------------------------------------------------------------------------------------------+ 
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | nodeSelector                                                                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | label                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``disktype: ssd``                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes nodeSelector                                                                  |
|                 | <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector>`_       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | affinity.topologyKey                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``kubernetes.io/hostname``                                                                |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The Operator `topology key                                                                |
|                 | <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/                       |
|                 | #affinity-and-anti-affinity>`_ node anti-affinity constraint                              |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | affinity.advanced                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | subdoc                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     |                                                                                           |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | If available it makes a `topologyKey                                                      |
|                 | <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/                       |
|                 | #inter-pod-affinity-and-anti-affinity-beta-feature>`_ node affinity constraint to be      |
|                 | ignored                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | affinity.tolerations                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | subdoc                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``node.alpha.kubernetes.io/unreachable``                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes Pod tolerations                                                               |
|                 | <https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/>`_               |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.emptyDir                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``{}``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes emptyDir volume                                                           |
|                 | <https://kubernetes.io/docs/concepts/storage/volumes/#emptydir>`_ The directory created   |
|                 | on a node and accessible to the PXC Pod containers                                        |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.hostPath.path                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``/data``                                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | `Kubernetes hostPath <https://kubernetes.io/docs/concepts/storage/volumes/#hostpath>`_    |
|                 | The volume that mounts a directory from the host node's filesystem into your Pod. The     |
|                 | path property is required                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.hostPath.type                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``Directory``                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes hostPath <https://kubernetes.io/docs/concepts/storage/volumes/            |
|                 | #hostpath>`_. An optional property for the hostPath                                       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.persistentVolumeClaim.storageClassName                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``standard``                                                                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Set the `Kubernetes storage class                                                         |
|                 | <https://kubernetes.io/docs/concepts/storage/storage-classes/>`_ to use with the PXC      |
|                 | `PersistentVolumeClaim <https://kubernetes.io/docs/concepts/storage/persistent-volumes/   |
|                 | #persistentvolumeclaims>`_                                                                |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.persistentVolumeClaim.accessModes                                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | array                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``[ReadWriteOnce]``                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes PersistentVolumeClaim                                                     |
|                 | <https://kubernetes.io/docs/concepts/storage/persistent-volumes/                          |
|                 | #persistentvolumeclaims>`_ access modes for the Percona XtraDB cluster                    |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | volumeSpec.resources.requests.storage                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``6Gi``                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes PersistentVolumeClaim                                                     |
|                 | <https://kubernetes.io/docs/concepts/storage/persistent-volumes/#                         |
|                 | persistentvolumeclaims>`_ size for the Percona XtraDB cluster                             |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | podDisruptionBudget.maxUnavailable                                                        |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``1``                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes podDisruptionBudget                                                       |
|                 | <https://kubernetes.io/docs/tasks/run-application/configure-pdb/                          |
|                 | #specifying-a-poddisruptionbudget>`_ specifies the number of Pods from the set            |
|                 | unavailable after the eviction                                                            |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | podDisruptionBudget.minAvailable                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``0``                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes podDisruptionBudget                                                       |
|                 | <https://kubernetes.io/docs/tasks/run-application/configure-pdb/                          |
|                 | #specifying-a-poddisruptionbudget>`_ Pods that must be available after an eviction        |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | gracePeriod                                                                               |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``30``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes grace period when terminating a Pod                                       |
|                 | <https://kubernetes.io/docs/concepts/workloads/pods/pod/#termination-of-pods>`_           |
+-----------------+-------------------------------------------------------------------------------------------+

.. _operator.pmm-section:

`PMM Section <operator.html#operator-pmm-section>`_
--------------------------------------------------------------------------------

The ``pmm`` section in the `deploy/cr.yaml <https://github.com/percona/percona-xtradb-cluster-operator/blob/master/deploy/cr.yaml>`_  file contains configuration
options for Percona Monitoring and Management.

+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | enabled                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | boolean                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``false``                                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Enables or disables `monitoring Percona XtraDB cluster with PMM                           |
|                 | <https://www.percona.com/doc/percona-xtradb-cluster/5.7/manual/monitoring.html>`_         |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | image                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``perconalab/pmm-client:1.17.1``                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | PMM client Docker image to use                                                            |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | serverHost                                                                                |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       |  string                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     |  ``monitoring-service``                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Address of the PMM Server to collect data from the cluster                                |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | serverUser                                                                                |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``pmm``                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `PMM Serve_User                                                                       |
|                 | <https://www.percona.com/doc/percona-monitoring-and-management/glossary.option.html>`_.   |
|                 | The PMM Server password should be configured using Secrets                                |
+-----------------+-------------------------------------------------------------------------------------------+

.. _operator.backup-section:

`Backup Section <operator.html#operator-backup-section>`_
--------------------------------------------------------------------------------

The ``backup`` section in the
`deploy/cr.yaml <https://github.com/percona/percona-xtradb-cluster-operator/blob/master/deploy/cr.yaml>`_
file contains the following configuration options for the regular
Percona XtraDB Cluster backups.

+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | image                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``percona/percona-xtradb-cluster-operator:1.0.0-backup``                                  |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The Percona XtraDB cluster Docker image to use for the backup                             |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | imagePullSecrets.name                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``private-registry-credentials``                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes imagePullSecrets                                                          |
|                 | <https://kubernetes.io/docs/concepts/configuration/secret/#using-imagepullsecrets>`_ for  |
|                 | the specified image                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.type                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``s3``                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The cloud storage type used for backups. Only ``s3`` and ``filesystem`` types are         |
|                 | supported                                                                                 |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.s3.credentialsSecret                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``my-cluster-name-backup-s3``                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes secret <https://kubernetes.io/docs/concepts/configuration/secret/>`_ for  |
|                 | backups. It should contain ``AWS_ACCESS_KEY_ID`` and ``AWS_SECRET_ACCESS_KEY`` keys.      |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.s3.bucket                                                                        |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     |                                                                                           |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Amazon S3 bucket <https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html>`_|
|                 | name for backups                                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.s3.region                                                                        |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``us-east-1``                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `AWS region <https://docs.aws.amazon.com/general/latest/gr/rande.html>`_ to use.      |
|                 | Please note **this option is mandatory** for Amazon and all S3-compatible storages        |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.s3.endpointUrl                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     |                                                                                           |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The endpoint URL of the S3-compatible storage to be used (not needed for the original     |
|                 | Amazon S3 cloud)                                                                          |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.persistentVolumeClaim.type                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``filesystem``                                                                            |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The persistent volume claim storage type                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.persistentVolumeClaim.storageClassName                                           |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``standard``                                                                              |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Set the `Kubernetes Storage Class                                                         |
|                 | <https://kubernetes.io/docs/concepts/storage/storage-classes/>`_ to use with the PXC      |
|                 | backups `PersistentVolumeClaims                                                           |
|                 | <https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims>`_|
|                 | for the ``filesystem`` storage type                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | storages.persistentVolumeClaim.accessModes                                                |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | array                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``[ReadWriteOne]``                                                                        |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The `Kubernetes PersistentVolume access modes                                             |
|                 | <https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes>`_          |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         |storages.persistentVolumeClaim.storage                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``6Gi``                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Storage size for the PersistentVolume                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | schedule.name                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``sat-night-backup``                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The backup name                                                                           |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | schedule.schedule                                                                         |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``0 0 * * 6``                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Scheduled time to make a backup specified in the                                          |
|                 | `crontab format <https://en.wikipedia.org/wiki/Cron>`_                                    |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | schedule.keep                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | int                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``3``                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | Number of stored backups                                                                  |
+-----------------+-------------------------------------------------------------------------------------------+
|                                                                                                             |
+-----------------+-------------------------------------------------------------------------------------------+
| **Key**         | schedule.storageName                                                                      |
+-----------------+-------------------------------------------------------------------------------------------+
| **Value**       | string                                                                                    |
+-----------------+-------------------------------------------------------------------------------------------+
| **Example**     | ``s3-us-west``                                                                            |
+-----------------+-------------------------------------------------------------------------------------------+
| **Description** | The name of the storage for the backups configured in the ``storages`` or ``fs-pvc``      |
|                 | subsection                                                                                |
+-----------------+-------------------------------------------------------------------------------------------+

